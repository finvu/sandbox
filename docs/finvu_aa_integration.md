# Integrating with Finvu AA (Account Aggregator)

If you are building your own FIU module you would need to first build the FIU functionality and the APIs.

Once you have built out the API and respective FIU functionality , you can start testing with Finvu Account Aggregator APIs. 

Before that there are certain pre-requisites that need to be done for security and authentication when calling the APIs. 

## Pre-Requisites before testing
Follow below steps.

1. Share your root endpoint with us on `support@cookiejar.co.in`

	e.g. `https://api.fiu.com`

2. Share the public key portion only on `support@cookiejar.co.in` of your generated key for signature verification and authorization. 

	Refer to the **[How-To](/how_to/)** section for more details on JSON Web key generation and signing.

3. In order to use the AA api, a token has to be acquired that needs to be passed in the API header. Reach out to us on `support@cookiejar.co.in` to request for the  API token. 

	This needs to be set in the `client_api_key` header when calling our AA apis.

	!!! attention "Token expiry"
		The token will have a **expiry of 6 months** in the sandbox environment following which API calls would fail.

4. Generate a token and share with us on `support@cookiejar.co.in` . We will use this token in header `aa_api_key` when we call your FIU notification apis. 

!!! note "Sharing of Metadata Information"
	In the future this process will be automated and centralized so communication would be seamless for token generation, public key retrieval, updates, token expiration notifications, etc.


## Finvu AA Endpoint
The Finvu AA api endpoint is `https://aauat.finvu.in/API/V1`


## Request headers (To be set for every API request)

Below `HTTP` headers need to be set as part of each request when calling our AA apis

  |  Key          |   Value       |	Description	|
  | ------------- |-------------|-------------|
  | `content-Type` | `application/json` | API request and response are in JSON format |
  | `Accept` | `application/json` | |
  | `client_api_key`   | Sample ```eyJraWQiOiJqYXlAZmludnUuaW4iLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJjb29raWVqYXIiLCJleHAiOjE1OTEyNjMwMDMsImp0aSI6IjRxeXFpWV9aZGJpTW1qQ2lqT0ZMckEiLCJpYXQiOjE1NTk3MjcwMDMsIm5iZiI6MTU1OTcyNzAwMywic3ViIjoiamF5QGZpbnZ1LmluIiwiZ3JvdXBzIjpbImFnZ3JlZ2F0b3IiXX0.Ctd9EUpn0CrfEG8b9ouBcG8ilVuPWzXkxZFOhuTCRdpiVzi6M05ABJ9THJ1QE4n__r74r8KHSxDgdeV1L-8mek68i9m5BYgqaka5VKoCLiN0B22Xvy2QFski1ZLQhm7Va2NioVvilGGWBDlpW_csuChA2yobml1jqomr8SGya6MFbDURRmJjdL6oRTysoCYxeFzU2_JCud2ljMvaWsjSlnrYXQWaWaoJBAhz3AWNXdzU0u6mhq1mvksRl3xXJDiAVkY0KvZXRNjsJDYQfVJjavh9n0fZelJIWMHznp9mLpxRfrr_qo6hiTkX2QtbbmKfhc0_BXsKNOdxEXJmieOPSA```      | The AA token that was shared by us and shared with you. Reference to Step 3.  |
  | `x-jws-signature`   | Sample `eyJhbGciOiJSUzI1NiIsImtpZCI6IjUzMzEwNzkyLTgwMDYtNGU3NC1iYmJlLWNiZGRlYjg5ZjMwYiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..h1FWwXanmcWgxUtHwlNWtD5_sE3HLjqd2rjE_c1WiPBvOHKJ4hs5oYlRdT663r7z7FV3WqP7tErNCzOlWUpu7j9JXKu7t4ObkCwx4pEZVySFcrI_0dpPAB43JlHeADeBwRX145tx6UC4yk4mIOTBrjdh2Yf0RZ7wOoyKys44mNqf0WJIZ2gO7bcm-WfTDW_5Y-tAO3LfyU2cQSyi1Jnc5q8qODXb_TsAYJOvANq0QGlstjEFwytnFsgPtyELjnjHMWgeTuDerw45xdNhdtNkR8UUHgajG2CFQwjEgpeOvZXbj0EeqbIgszXHsTHEfzRM6ZMMMEGcO_aXRUV3A6zZJQ`      | The detached signature of the body generated by your FIU module.  Reference to Step 2. |


## Finvu AA API 

Below are the AA api in order to integrate with the Finvu Account Aggregator ecosystem. These APIs confirm to the ReBIT API specifications.

### Consents
This API is intended for FIU/AA Client to request generation of digitally signed consent artefacts.

HTTP METHOD: `POST`

Relative URL: `/Consent`

URL: `https://aauat.finvu.in/API/V1/Consent`

Below `http` headers need to be set as part of each request

  |  Key          |   Value       |
  | ------------- |-------------|
  | `content-Type` | `application/json` |
  | `Accept` | `application/json` |
  | `fip_api_key`   | Sample`eyJraWQiOiJqYXlAZmludnUuaW4iLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJjb29raWVqYXIiLCJleHAiOjE1OTEyNjMwMDMsImp0aSI6IjRxeXFpWV9aZGJpTW1qQ2lqT0ZMckEiLCJpYXQiOjE1NTk3MjcwMDMsIm5iZiI6MTU1OTcyNzAwMywic3ViIjoiamF5QGZpbnZ1LmluIiwiZ3JvdXBzIjpbImFnZ3JlZ2F0b3IiXX0.Ctd9EUpn0CrfEG8b9ouBcG8ilVuPWzXkxZFOhuTCRdpiVzi6M05ABJ9THJ1QE4n__r74r8KHSxDgdeV1L-8mek68i9m5BYgqaka5VKoCLiN0B22Xvy2QFski1ZLQhm7Va2NioVvilGGWBDlpW_csuChA2yobml1jqomr8SGya6MFbDURRmJjdL6oRTysoCYxeFzU2_JCud2ljMvaWsjSlnrYXQWaWaoJBAhz3AWNXdzU0u6mhq1mvksRl3xXJDiAVkY0KvZXRNjsJDYQfVJjavh9n0fZelJIWMHznp9mLpxRfrr_qo6hiTkX2QtbbmKfhc0_BXsKNOdxEXJmieOPSA`      |
  | `x-jws-signature`   | Sample`eyJhbGciOiJSUzI1NiIsImtpZCI6IjUzMzEwNzkyLTgwMDYtNGU3NC1iYmJlLWNiZGRlYjg5ZjMwYiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..h1FWwXanmcWgxUtHwlNWtD5_sE3HLjqd2rjE_c1WiPBvOHKJ4hs5oYlRdT663r7z7FV3WqP7tErNCzOlWUpu7j9JXKu7t4ObkCwx4pEZVySFcrI_0dpPAB43JlHeADeBwRX145tx6UC4yk4mIOTBrjdh2Yf0RZ7wOoyKys44mNqf0WJIZ2gO7bcm-WfTDW_5Y-tAO3LfyU2cQSyi1Jnc5q8qODXb_TsAYJOvANq0QGlstjEFwytnFsgPtyELjnjHMWgeTuDerw45xdNhdtNkR8UUHgajG2CFQwjEgpeOvZXbj0EeqbIgszXHsTHEfzRM6ZMMMEGcO_aXRUV3A6zZJQ`      |


Sample Request Body
``` json
{
        "ver": "1.1.3",
        "timestamp": "2019-05-02T06:49:35.645Z",
        "txnid": "4a4adbbe-29ae-11e8-a8d7-0289437bf731",
        "ConsentDetail": {
          "consentStart": "2019-12-06T11:39:57.153Z",
          "consentExpiry": "2020-12-06T11:39:57.153Z",
          "consentMode": "VIEW",
          "fetchType": "PERIODIC",
          "consentTypes": [
            "TRANSACTIONS"
          ],
          "fiTypes": [
            "DEPOSIT"
          ],
          "DataConsumer": {
            "id": "fiu@bajajfinance"
          },
          "Customer": {
            "id": "jay@finvu"
          },
          "Purpose": {
            "code": "101",
            "refUri": "https://api.rebit.org.in/aa/purpose/101.xml",
            "text": "Wealth management service",
            "Category": {
        "type": "string"
            }
          },
          "FIDataRange": {
            "from": "2018-10-31T04:10:12.898",
        "to": "2019-10-31T04:10:12.897"
          },
          "DataLife": {
            "unit": "MONTH",
            "value": 4
          },
          "Frequency": {
            "unit": "MONTH",
            "value": 2
          },
          "DataFilter": [
            {
        "type": "TRANSACTIONAMOUNT",
        "operator": ">=",
        "value": 20000
            }
          ]
        }
      }
```

Response Expected
``` json
    {
        "ver": "1.1.3",
        "timestamp": "2020-04-09T07:24:33.592+0000",
        "txnid": "4a4adbbe-29ae-11e8-a8d7-0289437bf731",
        "Customer": {
      "id": "jay@finvu"
        },
        "ConsentHandle": "2c75ad41-49e0-438c-bd7c-8af9db072065"
    }
```

### Status of Consent Request
This API is intended for checking the status of a previously submitted Consent Artefacts creation request

HTTP METHOD: `GET`

RELATIVE URL: `/handle/{consentHandle}`

URL: `https://aauat.finvu.in/API/V1/Consent/handle/{consentHandle}`

e.g. : https://aauat.finvu.in/API/V1/Consent/handle/2c75ad41-49e0-438c-bd7c-8af9db072065

Below `http` headers need to be set as part of each request

  |  Key          |   Value       |
  | ------------- |:-------------:|
  | `content-Type` | `application/json` |
  | `Accept` | `application/json` |
  | `fip_api_key`   | Sample`eyJraWQiOiJqYXlAZmludnUuaW4iLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJjb29raWVqYXIiLCJleHAiOjE1OTEyNjMwMDMsImp0aSI6IjRxeXFpWV9aZGJpTW1qQ2lqT0ZMckEiLCJpYXQiOjE1NTk3MjcwMDMsIm5iZiI6MTU1OTcyNzAwMywic3ViIjoiamF5QGZpbnZ1LmluIiwiZ3JvdXBzIjpbImFnZ3JlZ2F0b3IiXX0.Ctd9EUpn0CrfEG8b9ouBcG8ilVuPWzXkxZFOhuTCRdpiVzi6M05ABJ9THJ1QE4n__r74r8KHSxDgdeV1L-8mek68i9m5BYgqaka5VKoCLiN0B22Xvy2QFski1ZLQhm7Va2NioVvilGGWBDlpW_csuChA2yobml1jqomr8SGya6MFbDURRmJjdL6oRTysoCYxeFzU2_JCud2ljMvaWsjSlnrYXQWaWaoJBAhz3AWNXdzU0u6mhq1mvksRl3xXJDiAVkY0KvZXRNjsJDYQfVJjavh9n0fZelJIWMHznp9mLpxRfrr_qo6hiTkX2QtbbmKfhc0_BXsKNOdxEXJmieOPSA`     |
  | `x-jws-signature`   | Sample `eyJhbGciOiJSUzI1NiIsImtpZCI6IjUzMzEwNzkyLTgwMDYtNGU3NC1iYmJlLWNiZGRlYjg5ZjMwYiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..aJCoAxSCzq9A8AGf-7tzu6ve6FjBsJdDnc-JpocXqDIHp8tDIIvY-Xz7KboPlzDRfdaIJBLS6piejd_6WRi4ccyNt5OnT7kxdwokkiAdrIVPkQiXftChU-64Q1rXYA6Um12DT8Ic1iywJInuOXLUeMlF9gb7qkBXDqVBcXIhb9fpzuL3n31Pf0gFrMNfO2JtOGGZeOiFyiCuNS4acYnorupBeTFhFC65WHGsMrLWggzRRuzBPJlXv8AoXXDw7vJFUhoEwJpfQH5bCGA0hBiHrpK52r_O3tRHhyULIbf83aOhCpw0h4PJ9RvwVCqJ9xUc2sXAjY9HD1z1TOGa_7XWyQ`      |


Request Body

`No Request Body expected`

Response Expected: 
``` json
    {
        "ver": "1.1.3",
        "timestamp": "2020-04-09T07:24:33.592+0000",
        "txnid": "4a4adbbe-29ae-11e8-a8d7-0289437bf731",
        "ConsentHandle": "2c75ad41-49e0-438c-bd7c-8af9db072065",
        "ConsentStatus": {
      "id": null,
      "status": "PENDING"
        }
    }
```


### Consents/{id}

This API is intended for fetching the information associated with the specific consent.


HTTP METHOD: `GET`

RELATIVE URL: `/Consent/{id}`

URL: `https://aauat.finvu.in/API/V1/Consent/{id}`
e.g. : https://aauat.finvu.in/API/V1/Consent/79072af5-c41f-4cae-ac59-e233b82ea750

Below `http` headers need to be set as part of each request

  |  Key          |   Value       |
  | ------------- |:-------------:|
  | `content-Type` | `application/json` |
  | `Accept` | `application/json` |
  | `fip_api_key`   | Sample `eyJraWQiOiJqYXlAZmludnUuaW4iLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJjb29raWVqYXIiLCJleHAiOjE1OTEyNjMwMDMsImp0aSI6IjRxeXFpWV9aZGJpTW1qQ2lqT0ZMckEiLCJpYXQiOjE1NTk3MjcwMDMsIm5iZiI6MTU1OTcyNzAwMywic3ViIjoiamF5QGZpbnZ1LmluIiwiZ3JvdXBzIjpbImFnZ3JlZ2F0b3IiXX0.Ctd9EUpn0CrfEG8b9ouBcG8ilVuPWzXkxZFOhuTCRdpiVzi6M05ABJ9THJ1QE4n__r74r8KHSxDgdeV1L-8mek68i9m5BYgqaka5VKoCLiN0B22Xvy2QFski1ZLQhm7Va2NioVvilGGWBDlpW_csuChA2yobml1jqomr8SGya6MFbDURRmJjdL6oRTysoCYxeFzU2_JCud2ljMvaWsjSlnrYXQWaWaoJBAhz3AWNXdzU0u6mhq1mvksRl3xXJDiAVkY0KvZXRNjsJDYQfVJjavh9n0fZelJIWMHznp9mLpxRfrr_qo6hiTkX2QtbbmKfhc0_BXsKNOdxEXJmieOPSA`      |
  | `x-jws-signature`   | Sample`eyJhbGciOiJSUzI1NiIsImtpZCI6IjUzMzEwNzkyLTgwMDYtNGU3NC1iYmJlLWNiZGRlYjg5ZjMwYiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..uyaTRfeArHdcxkYsKsJKDmJ7ieSpuQEVULvLzniIgYPEvmhx4cOGKUfGmY48ObrkhJVWM5swwmmH6ythwRq5WI7JdtuexdV73iJZfZ6vQicWy_Wx8grfdGbsYoRACgxuTRcgZgYXSKJN0BahLk3Unhk5udPqYL-hOilygfYdfFox-2cjbSs9i5P2DOftOUOXwFL_8l4xPJz24jKqLrJtdVfi0ba9hSvACN3ULh9bl6HK7RwIHPyUBYNUsFY5UO-P0mY-ey6ia1R78_TzK8DReT3s8K1jOUgM-mZyikqjjRimVppxexT5JDhEDy5ja6pvHoa04PibQnLTyKirAtSGfg`      |


Request Body
`No Request Body expected`

Response Expected: 
``` json
    {
        "ver": "1.1.3",
        "txnid": "1f242d7e-63aa-47b4-be7f-a1b442fff02f",
        "consentId": "79072af5-c41f-4cae-ac59-e233b82ea750",
        "status": "ACTIVE",
        "createTimestamp": "2020-04-09T07:47:17.170+0000",
        "signedConsent": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImY2NzZiNjg4LTA3YTItNDUwYi1hYmI1LTU3ZmJiOThlY2FiZSIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19.eyJjb25zZW50U3RhcnQiOjE1NzU2MzIzOTcxNTMsImNvbnNlbnRFeHBpcnkiOjE2MDcyNTQ3OTcxNTMsImNvbnNlbnRNb2RlIjoiVklFVyIsImZldGNoVHlwZSI6IlBFUklPRElDIiwiY29uc2VudFR5cGVzIjpbIlRSQU5TQUNUSU9OUyJdLCJmaVR5cGVzIjpbIkRFUE9TSVQiXSwiRGF0YUNvbnN1bWVyIjp7ImlkIjoiZml1QGJhamFqZmluYW5jZSIsInR5cGUiOiJGSVUifSwiRGF0YVByb3ZpZGVyIjp7ImlkIjoiY29va2llamFyLWFhQGZpbnZ1LmluIiwidHlwZSI6IkFBIn0sIkN1c3RvbWVyIjp7ImlkIjoiamF5QGZpbnZ1In0sIkFjY291bnRzIjpbeyJmaVR5cGUiOiJERVBPU0lUIiwiZmlwSWQiOiJCQVJCMEtJTVhYWCIsImFjY1R5cGUiOiJDVVJSRU5UIiwibGlua1JlZk51bWJlciI6IjAzOTQ4ODU2NjY4ODAwIiwibWFza2VkQWNjTnVtYmVyIjoiWFhYWFhYWFhYODAwMCJ9XSwiUHVycG9zZSI6eyJjb2RlIjoiMTAxIiwicmVmVXJpIjoiaHR0cHM6Ly9hcGkucmViaXQub3JnLmluL2FhL3B1cnBvc2UvMTAxLnhtbCIsInRleHQiOiJXZWFsdGggbWFuYWdlbWVudCBzZXJ2aWNlIiwiQ2F0ZWdvcnkiOnsidHlwZSI6InN0cmluZyJ9fSwiRklEYXRhUmFuZ2UiOnsiZnJvbSI6MTU0MDk1OTAxMjg5OCwidG8iOjE1NzI0OTUwMTI4OTd9LCJEYXRhTGlmZSI6eyJ1bml0IjoiTU9OVEgiLCJ2YWx1ZSI6NH0sIkZyZXF1ZW5jeSI6eyJ1bml0IjoiTU9OVEgiLCJ2YWx1ZSI6Mn0sIkRhdGFGaWx0ZXIiOlt7InR5cGUiOiJUUkFOU0FDVElPTkFNT1VOVCIsIm9wZXJhdG9yIjoiPj0iLCJ2YWx1ZSI6IjIwMDAwIn1dfQ.lTpCKEu7Q9fZpJK6okY-DvmKCqUI28WdhRPL8thSzftTAhObprL8SsJsaXDzTWZnFxUM7EFl7ALvHvxajO_QshGP76MS-8XvkoilV0jWYYSM34-BqWUNhHaTsJC2hAVCPiBk9aWVnIOVoJFgoRHxHLeXt2tphIxKFJ6h5AVLGJw2flEWf19yId-Ra_O21D3CqxbO3kdQa_E2mutqvz0RRWqrLyEgTBP6Lh-4O-g7iTXZ1w4i6tggWhe9M0i9pLqjN8Y6_TgxIWWLoMd3r_0QEb3dwY5rFKeKaHS5JL5EDdmnMBaqfj4WMN9y0mTb1LKFrc8UW2ligDyY3qBPXs021Q",
        "ConsentUse": {
      "logUri": "consent_use_loguri",
      "count": 0,
      "lastUseDateTime": "2020-04-09T07:47:13.032+0000"
        }
    }
```


### /FI/request

The FIU or the User submits the Consent IDs of the consents required for fetching financial information from the FIP(s).


HTTP METHOD: `POST`

RELATIVE URL: `/FI/request`

URL: `https://aauat.finvu.in/API/V1/FI/request`

Below `http` headers need to be set as part of each request

  |  Key          |   Value       |
  | ------------- |:-------------:|
  | `content-Type` | `application/json` |
  | `Accept` | `application/json` |
  | `fip_api_key`   | Sample `eyJraWQiOiJqYXlAZmludnUuaW4iLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJjb29raWVqYXIiLCJleHAiOjE1OTEyNjMwMDMsImp0aSI6IjRxeXFpWV9aZGJpTW1qQ2lqT0ZMckEiLCJpYXQiOjE1NTk3MjcwMDMsIm5iZiI6MTU1OTcyNzAwMywic3ViIjoiamF5QGZpbnZ1LmluIiwiZ3JvdXBzIjpbImFnZ3JlZ2F0b3IiXX0.Ctd9EUpn0CrfEG8b9ouBcG8ilVuPWzXkxZFOhuTCRdpiVzi6M05ABJ9THJ1QE4n__r74r8KHSxDgdeV1L-8mek68i9m5BYgqaka5VKoCLiN0B22Xvy2QFski1ZLQhm7Va2NioVvilGGWBDlpW_csuChA2yobml1jqomr8SGya6MFbDURRmJjdL6oRTysoCYxeFzU2_JCud2ljMvaWsjSlnrYXQWaWaoJBAhz3AWNXdzU0u6mhq1mvksRl3xXJDiAVkY0KvZXRNjsJDYQfVJjavh9n0fZelJIWMHznp9mLpxRfrr_qo6hiTkX2QtbbmKfhc0_BXsKNOdxEXJmieOPSA`      |
  | `x-jws-signature`   | Sample `eyJhbGciOiJSUzI1NiIsImtpZCI6IjUzMzEwNzkyLTgwMDYtNGU3NC1iYmJlLWNiZGRlYjg5ZjMwYiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..i_KCXG3hYR_Wq2aFo0f6mVOo2BCFuzi2DTDYPSDgg9VI9ydqq6ypu_xh2WM6yBmYW-mGdt1E6q9OcG-ACOIrRhFBVE2QdN0A0g3Py1GAjGt0IzwjUzdChq7R7z6IICOttDT4T-hTnAmOm188LmIdmOS7xq5RTo87w_hr79_HOAa-_umfRVhYGmhgr7IHy6yT_UqLcNg3yN1j3JdzXrivJT68BYqMVE1cUrNNbU0-yaF7WxVxb5Yak-Tkjr1cZSrRgwI4HNEZX8i51MXpBAjkcCbahdrnTk7xdEsvroDKfCuFi38JF2IC0zIWvHv19uWPJ4iAkTDMsOWj_P7fCu-p4w`      |



Request Body
``` json
      {
          "ver": "1.1.3",
          "timestamp": 1586430349059,
          "txnid": "0b538f95-38de-4ed6-be51-d55c2d8fe6f1",
          "FIDataRange": {
        "from": "2018-10-31T04:10:12.898",
        "to": "2019-10-31T04:10:12.897"
          },
          "Consent": {
        "id": "237f245e-20fd-4bb3-8d95-47855f1f2cb1",
        "digitalSignature": "HJMUEnmffI1-5ia_nahomS-fvJSP1ORDbBoPkbfB0tNMttcDVjfTHTZGUvibEI7W5B99PIEABN7oNFslAGr1B6aYfScYxlCmj1nVprhf9WqXDHT1iThKEnLsKcocM21AVxjlxjtgMHkNTIs2NXGf7U5cCs-FwDrDKwaZPF8PT1gtrV1coxmT6o7lwOla2VYoN02gaH55tdAhboZ0zxBoauTeKIJXrSJ0t_yJ8OGeYNRMlyqv2456doey5bGy91UOl20nXfrc3RPYTHvZ2yMFvdWlA4J05KXLxzVDqMwcUr91YL9An4ZIlXKukbBJJhOkAa_0vXRkySsTQ8E4NqHYiA"
          },
          "KeyMaterial": {
        "cryptoAlg": "ECDH",
        "curve": "Curve25519",
        "params": "params",
        "DHPublicKey": {
            "expiry": "2020-06-01T15:25:50.505Z",
            "Parameters": "params",
            "KeyValue": "-----BEGIN PUBLIC KEY-----MIIBMTCB6gYHKoZIzj0CATCB3gIBATArBgcqhkjOPQEBAiB/////////////////////////////////////////7TBEBCAqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqYSRShRAQge0Je0Je0Je0Je0Je0Je0Je0Je0Je0Je0JgtenHcQyGQEQQQqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq0kWiCuGaG4oIa04B7dLHdI0UySPU1+bXxhsinpxaJ+ztPZAiAQAAAAAAAAAAAAAAAAAAAAFN753qL3nNZYEmMaXPXT7QIBCANCAARBy9oxpJ/dHJCBfJsXuf2HWhfREj/xkr4xK3Uoj4tOOUPnwkyEcXsVgc7uQW4hfHptkAyFfW4/ltmOwYiEPnZg-----END PUBLIC KEY-----"
        },
        "Nonce": "MqmdF9qAfaCt9i9qewn3AmdWOPIkC7cjUDeLDdNPDEM="
          }
      }
```
Response Expected: 
``` json
    {
        "ver": "1.1.3",
        "timestamp": "2020-04-14T06:04:34.727+0000",
        "txnid": "0b538f95-38de-4ed6-be51-d55c2d8fe6f1",
        "consentId": "237f245e-20fd-4bb3-8d95-47855f1f2cb1",
        "sessionId": "e4e3fb59-d682-48c7-80e2-770967ba2477"
    }
```

### /FI/fetch/{sessionId}

Once FIU receives the notification <Data-Ready> from AA, using digitally signed consent request received from AA, this API can be used to fetch the financial information from the AA.


HTTP METHOD: `GET`

RELATIVE URL: `/FI/fetch/{sessionId}`

URL: `https://aauat.finvu.in/API/V1/FI/fetch/{sessionId}`
e.g. : https://aauat.finvu.in/API/V1/FI/fetch/e4e3fb59-d682-48c7-80e2-770967ba2477

Below `http` headers need to be set as part of each request

  |  Key          |   Value       |
  | ------------- |:-------------:|
  | `content-Type` | `application/json` |
  | `Accept` | `application/json` |
  | `fip_api_key`   | Sample `eyJraWQiOiJqYXlAZmludnUuaW4iLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJjb29raWVqYXIiLCJleHAiOjE1OTEyNjMwMDMsImp0aSI6IjRxeXFpWV9aZGJpTW1qQ2lqT0ZMckEiLCJpYXQiOjE1NTk3MjcwMDMsIm5iZiI6MTU1OTcyNzAwMywic3ViIjoiamF5QGZpbnZ1LmluIiwiZ3JvdXBzIjpbImFnZ3JlZ2F0b3IiXX0.Ctd9EUpn0CrfEG8b9ouBcG8ilVuPWzXkxZFOhuTCRdpiVzi6M05ABJ9THJ1QE4n__r74r8KHSxDgdeV1L-8mek68i9m5BYgqaka5VKoCLiN0B22Xvy2QFski1ZLQhm7Va2NioVvilGGWBDlpW_csuChA2yobml1jqomr8SGya6MFbDURRmJjdL6oRTysoCYxeFzU2_JCud2ljMvaWsjSlnrYXQWaWaoJBAhz3AWNXdzU0u6mhq1mvksRl3xXJDiAVkY0KvZXRNjsJDYQfVJjavh9n0fZelJIWMHznp9mLpxRfrr_qo6hiTkX2QtbbmKfhc0_BXsKNOdxEXJmieOPSA`      |
  | `x-jws-signature`   | sample `eyJhbGciOiJSUzI1NiIsImtpZCI6IjUzMzEwNzkyLTgwMDYtNGU3NC1iYmJlLWNiZGRlYjg5ZjMwYiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..XYmRm_uBnQmQSgKtBjBz55hIcCEiJxhDLYQZDP0DKwKYzkVofd4Ag_oUljtSY-Y8cxS78C7_pEsRcydzOYNlkjsBgVxlJQaI89rIQyz1vzQRFYffwjM5IKSwSjNgNiZpU3pr8IgOHSPDOurg7Th-Z62LNp82JMsxAnBp0QiSWgcbLcoxz1n3F7CpTQsNtwxlMa2w7M5bvbKuA27uIthNsL3agEGyT6a6mKds22HcjkPrJDuKNtdcOrH7Fm_WcYunpGMFLoOFmbDXVIkHfIhVixQqH8s0GYSKPAHYxnUj-7Er3WY3uGiA1bFzyiiqaxdOt4YhOLmr_9C5lQ9Ir6t1fQ`      |


Response Expected: 
``` json
{
        "ver": "1.1.3",
        "timestamp": "2020-04-09T11:05:49.059+0000",
        "txnid": "0b538f95-38de-4ed6-be51-d55c2d8fe6f1",
        "FI": [
      {
          "fipID": "BARB0KIMXXX",
          "data": [
        {
            "linkRefNumber": "03948856668800",
            "maskedAccNumber": "XXXXXXXXX8000",
            "encryptedFI": "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"
        }
          ],
          "KeyMaterial": {
        "cryptoAlg": null,
        "curve": "ECDH",
        "params": "Curve25519",
        "DHPublicKey": {
            "expiry": "2020-04-15T06:04:34.812+0000",
            "Parameters": null,
            "KeyValue": "-----BEGIN PUBLIC KEY-----MIIBMTCB6gYHKoZIzj0CATCB3gIBATArBgcqhkjOPQEBAiB/////////////////////////////////////////7TBEBCAqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqYSRShRAQge0Je0Je0Je0Je0Je0Je0Je0Je0Je0Je0JgtenHcQyGQEQQQqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq0kWiCuGaG4oIa04B7dLHdI0UySPU1+bXxhsinpxaJ+ztPZAiAQAAAAAAAAAAAAAAAAAAAAFN753qL3nNZYEmMaXPXT7QIBCANCAARlEuyKQ/gHSBR0K52DzAx4E9qztndcnebrr5qKE82w+HIyriwjonA6p6E8PLXGn7U+GLchjuLSAaZRg4R8taDV-----END PUBLIC KEY-----"
        },
        "Nonce": "vnIxIOs19HZl6Ri78TiRWNC43Eve2Bodte53RBP43kY="
          }
      }
        ]
    }
```

### Consent Notification

API handles the notifications corresponding to the events generated during consent flow and data flow.


HTTP METHOD: `POST`

RELATIVE URL: `/Consent/Notification`

URL: `https://aauat.finvu.in/API/V1/Consent/Notification`

Below `http` headers need to be set as part of each request

  |  Key          |   Value       |
  | ------------- |:-------------:|
  | `content-Type` | `application/json` |
  | `Accept` | `application/json` |
  | `fip_api_key`   | Sample `eyJraWQiOiJqYXlAZmludnUuaW4iLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJjb29raWVqYXIiLCJleHAiOjE1OTEyNjMwMDMsImp0aSI6IjRxeXFpWV9aZGJpTW1qQ2lqT0ZMckEiLCJpYXQiOjE1NTk3MjcwMDMsIm5iZiI6MTU1OTcyNzAwMywic3ViIjoiamF5QGZpbnZ1LmluIiwiZ3JvdXBzIjpbImFnZ3JlZ2F0b3IiXX0.Ctd9EUpn0CrfEG8b9ouBcG8ilVuPWzXkxZFOhuTCRdpiVzi6M05ABJ9THJ1QE4n__r74r8KHSxDgdeV1L-8mek68i9m5BYgqaka5VKoCLiN0B22Xvy2QFski1ZLQhm7Va2NioVvilGGWBDlpW_csuChA2yobml1jqomr8SGya6MFbDURRmJjdL6oRTysoCYxeFzU2_JCud2ljMvaWsjSlnrYXQWaWaoJBAhz3AWNXdzU0u6mhq1mvksRl3xXJDiAVkY0KvZXRNjsJDYQfVJjavh9n0fZelJIWMHznp9mLpxRfrr_qo6hiTkX2QtbbmKfhc0_BXsKNOdxEXJmieOPSA`      |
  | `x-jws-signature`   | Sample `eyJhbGciOiJSUzI1NiIsImtpZCI6IjUzMzEwNzkyLTgwMDYtNGU3NC1iYmJlLWNiZGRlYjg5ZjMwYiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..sYAhIsKVs5tXX1Og4PeRzuVvmMesfiudUNPE7UoNLPO6KJLUChDyvKF_l5LbFNBspMwLYVrS01m9k6a6XdxcuAcIhBNEb4yoZcVKS1wLgMl8OXc-PjbqJeC-op3ovQk-KLRF9HlIl7_s3ADGEW4KRK8J10_HTIMgt_9OoL5OZkCq0l1dNhjBoR0Z-zM8RRqfOfKW4gFys51iU4fGSpA9p9EdoBlImU8FHpldPBwQsJumvuK06DJEWFehiauclkC4auuJvlm-3iWb9f1aPO60oT7BFUJRIUP4ezyjnAKqm_Eh-Vum5uPfAfHLVBDgVG04yYixgGuZoLu1kFdexa8bLA`      |


Request Body
``` json
      {
          "ver": "1.1.3",
          "timestamp": "2018-12-06T11:39:57.153Z",
          "txnid": "0b811819-9044-4856-b0ee-8c88035f8858",
          "Notifier": {
        "type": "FIP",
        "id": "BARB0KIMXXX"
          },
          "AccountLinkStatusNotification": {
        "maskedAccNumber": "XXXXXXX5555",
        "customerAddress": "jay29@finvu.in",
        "linkRefNumber": "fe78c883-e96a-44d2-b767-b818f64ed8a0",
        "linkStatus": "LINKED"
          }
      }
```
Response Expected: 
`200 OK`

### FI Notification

API handles the notifications corresponding to the events generated during consent flow and data flow.


HTTP METHOD: `POST`

RELATIVE URL: `/FI/Notification`

URL: `https://aauat.finvu.in/API/V1/FI/Notification`


Below `http` headers need to be set as part of each request

  |  Key          |   Value       |
  | ------------- |:-------------:|
  | `content-Type` | `application/json` |
  | `Accept` | `application/json` |
  | `fip_api_key`   | Sample `eyJraWQiOiJqYXlAZmludnUuaW4iLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJjb29raWVqYXIiLCJleHAiOjE1OTEyNjMwMDMsImp0aSI6IjRxeXFpWV9aZGJpTW1qQ2lqT0ZMckEiLCJpYXQiOjE1NTk3MjcwMDMsIm5iZiI6MTU1OTcyNzAwMywic3ViIjoiamF5QGZpbnZ1LmluIiwiZ3JvdXBzIjpbImFnZ3JlZ2F0b3IiXX0.Ctd9EUpn0CrfEG8b9ouBcG8ilVuPWzXkxZFOhuTCRdpiVzi6M05ABJ9THJ1QE4n__r74r8KHSxDgdeV1L-8mek68i9m5BYgqaka5VKoCLiN0B22Xvy2QFski1ZLQhm7Va2NioVvilGGWBDlpW_csuChA2yobml1jqomr8SGya6MFbDURRmJjdL6oRTysoCYxeFzU2_JCud2ljMvaWsjSlnrYXQWaWaoJBAhz3AWNXdzU0u6mhq1mvksRl3xXJDiAVkY0KvZXRNjsJDYQfVJjavh9n0fZelJIWMHznp9mLpxRfrr_qo6hiTkX2QtbbmKfhc0_BXsKNOdxEXJmieOPSA`      |
  | `x-jws-signature`   | Sample`eyJhbGciOiJSUzI1NiIsImtpZCI6IjUzMzEwNzkyLTgwMDYtNGU3NC1iYmJlLWNiZGRlYjg5ZjMwYiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..EibCG6y9f30eMEz4upmFw1a99mDnRZdz0MK5rNSuLreqDry8ug1lYvIHk7YfbzCQi5PnpLCtyyxthsFTmPnZvSDFNfmbprStPKbzcFyEDuwJT6xgHWutn_lJ-fGgDXjCQNRfJLNhrRcQkwbqgiNWnO5MzcSCj2fdgkxR2AQiB6Q1jmX5LFscxTJV5v7-QZ4MnTN3lEOUJPcx96RIthjsLGQI_xG3iYZf5XAhQTtcv64Ek5Ffv731Kd8xHwiRlL-6I9E7VOSgOSH_r0-ZC94xgMswb8EE-nKw5DkLHNlmesffzRYHOqeA4nNSWdSYoRGBuEbvWLx9VusXrw4AT2OoVw`      |
  

Request Body
``` json
      {
          "ver": "1.1.3",
          "timestamp": "2020-04-14T05:59:12.196+0000",
          "txnid": "800b4213-4da4-44ac-a195-3ef81817da45",
          "Notifier": {
        "type": "FIP",
        "id": "BARB0KIMXXX"
          },
          "FIStatusNotification": {
        "sessionId": "ec9e9e39-2879-4305-8678-11c12965af63",
        "sessionStatus": "COMPLETED",
        "FIStatusResponse": [
            {
          "fipID": "BARB0KIMXXX",
          "Accounts": [
              {
            "linkRefNumber": "03948856668800",
            "FIStatus": "READY",
            "description": "ACTIVE"
              }
          ]
            }
        ]
          }
      }
```
Response Expected: 
`200 OK`


### Account Link Notification

API handles the notifications corresponding to the events generated during consent flow and data flow.


HTTP METHOD: `POST`

RELATIVE URL: `/Account/link/Notification`

URL: `https://aauat.finvu.in/API/V1/Account/link/Notification`

Below `http` headers need to be set as part of each request

  |  Key          |   Value       |
  | ------------- |:-------------:|
  | `content-Type` | `application/json` |
  | `Accept` | `application/json` |
  | `fip_api_key`   | Sample`eyJraWQiOiJqYXlAZmludnUuaW4iLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJjb29raWVqYXIiLCJleHAiOjE1OTEyNjMwMDMsImp0aSI6IjRxeXFpWV9aZGJpTW1qQ2lqT0ZMckEiLCJpYXQiOjE1NTk3MjcwMDMsIm5iZiI6MTU1OTcyNzAwMywic3ViIjoiamF5QGZpbnZ1LmluIiwiZ3JvdXBzIjpbImFnZ3JlZ2F0b3IiXX0.Ctd9EUpn0CrfEG8b9ouBcG8ilVuPWzXkxZFOhuTCRdpiVzi6M05ABJ9THJ1QE4n__r74r8KHSxDgdeV1L-8mek68i9m5BYgqaka5VKoCLiN0B22Xvy2QFski1ZLQhm7Va2NioVvilGGWBDlpW_csuChA2yobml1jqomr8SGya6MFbDURRmJjdL6oRTysoCYxeFzU2_JCud2ljMvaWsjSlnrYXQWaWaoJBAhz3AWNXdzU0u6mhq1mvksRl3xXJDiAVkY0KvZXRNjsJDYQfVJjavh9n0fZelJIWMHznp9mLpxRfrr_qo6hiTkX2QtbbmKfhc0_BXsKNOdxEXJmieOPSA`     |
  | `x-jws-signature`   | Sample`eyJhbGciOiJSUzI1NiIsImtpZCI6IjUzMzEwNzkyLTgwMDYtNGU3NC1iYmJlLWNiZGRlYjg5ZjMwYiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19..sYAhIsKVs5tXX1Og4PeRzuVvmMesfiudUNPE7UoNLPO6KJLUChDyvKF_l5LbFNBspMwLYVrS01m9k6a6XdxcuAcIhBNEb4yoZcVKS1wLgMl8OXc-PjbqJeC-op3ovQk-KLRF9HlIl7_s3ADGEW4KRK8J10_HTIMgt_9OoL5OZkCq0l1dNhjBoR0Z-zM8RRqfOfKW4gFys51iU4fGSpA9p9EdoBlImU8FHpldPBwQsJumvuK06DJEWFehiauclkC4auuJvlm-3iWb9f1aPO60oT7BFUJRIUP4ezyjnAKqm_Eh-Vum5uPfAfHLVBDgVG04yYixgGuZoLu1kFdexa8bLA`      |

  
Sample Request Body
``` json
      {
          "ver": "1.1.3",
          "timestamp": "2018-12-06T11:39:57.153Z",
          "txnid": "0b811819-9044-4856-b0ee-8c88035f8858",
          "Notifier": {
        "type": "FIP",
        "id": "BARB0KIMXXX"
          },
          "AccountLinkStatusNotification": {
        "maskedAccNumber": "XXXXXXX5555",
        "customerAddress": "jay29@finvu.in",
        "linkRefNumber": "fe78c883-e96a-44d2-b767-b818f64ed8a0",
        "linkStatus": "LINKED"
          }
      }
```
Response Expected: 
`200 OK`

### Heartbeat

This API is used by FIUs to check availability of AAs.


HTTP METHOD: `GET`

RELATIVE URL: `/Heartbeat`

URL: `https://aauat.finvu.in/API/V1/Heartbeat`

Sample Request Body
`No Request Body expected`

Sample Response Expected: 
``` json
{
    "ver": "1.1.3",
    "timestamp": "2018-06-25T17:28:01.000+0000",
    "Status": "UP",
    "Error": {
        "code": 0,
        "msg": "OK",
        "detail": "Service is activated on network"
    }
}
```

## Sample data for testing
Whether you are building your own FIU or using our FIU, having access to sample data is a necessary. 

We have made it simple for you to enter data as per your requirements and have provided APIs for the same. 

Refer to the [Sample Test Data](/fip_data_api/) section for entering sample data. The data schemas are compliant with the [ReBIT FIType schemas](https://api.rebit.org.in/schema).

As data is sourced from FIP (Financial Information Provider) we have built a FIP sandbox as well. However as a FIU developer you need not worry about FIP as FIU never interact with FIP directly and communication is always through an AA. For reference more details of FIP at [FIP Sandbox](fip_simulator)

  